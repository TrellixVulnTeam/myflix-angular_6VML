{"ast":null,"code":"import { UserProfileUpdateComponent } from '../user-profile-update/user-profile-update.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../fetch-api-data.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/material/snack-bar\";\nimport * as i4 from \"@angular/material/dialog\";\nimport * as i5 from \"../nav-bar/nav-bar.component\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"@angular/material/card\";\nimport * as i9 from \"@angular/material/icon\";\n\nfunction UserProfileComponent_mat_card_27_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"mat-card\", 9);\n    i0.ɵɵelementStart(1, \"mat-card-actions\");\n    i0.ɵɵelementStart(2, \"mat-icon\", 10);\n    i0.ɵɵlistener(\"click\", function UserProfileComponent_mat_card_27_Template_mat_icon_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r3);\n      const favorite_r1 = restoredCtx.$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return ctx_r2.removeFavorites(favorite_r1._id, favorite_r1.Title);\n    });\n    i0.ɵɵtext(3, \" delete_outline \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"mat-card-header\");\n    i0.ɵɵelementStart(5, \"mat-card-title\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"mat-card-subtitle\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(9, \"img\", 11);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const favorite_r1 = ctx.$implicit;\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(favorite_r1.Title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(favorite_r1.Director.Name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"src\", favorite_r1.ImagePath, i0.ɵɵsanitizeUrl);\n    i0.ɵɵpropertyInterpolate(\"alt\", favorite_r1.Title);\n  }\n}\n\nexport let UserProfileComponent = /*#__PURE__*/(() => {\n  class UserProfileComponent {\n    constructor(fetchApiData, fetchApiData2, fetchApiData3, router, snackBar, dialog) {\n      this.fetchApiData = fetchApiData;\n      this.fetchApiData2 = fetchApiData2;\n      this.fetchApiData3 = fetchApiData3;\n      this.router = router;\n      this.snackBar = snackBar;\n      this.dialog = dialog;\n      this.user = {};\n      this.movies = [];\n      this.favorites = [];\n    }\n\n    ngOnInit() {\n      this.getUser();\n    }\n\n    getUser() {\n      let FavoriteMovies = localStorage.getItem('FavoriteMovies');\n      let Username = localStorage.getItem('user');\n      let Email = localStorage.getItem('Email');\n      let Birthday = localStorage.getItem('Birthday');\n      this.user = {\n        \"FavoriteMovies\": FavoriteMovies,\n        \"Username\": Username,\n        \"Email\": Email,\n        \"Birthday\": Birthday\n      };\n      this.getMovies();\n    }\n\n    getMovies() {\n      this.fetchApiData.getAllMovies().subscribe(resp => {\n        this.movies = resp;\n        this.filterFavorites();\n      });\n    }\n\n    filterFavorites() {\n      this.movies.forEach(movie => {\n        if (this.user.FavoriteMovies.includes(movie._id)) {\n          this.favorites.push(movie);\n        }\n      });\n      return this.favorites;\n    }\n\n    removeFavorites(id, title) {\n      this.fetchApiData2.deleteFavouriteMovie(id).subscribe(resp => {\n        console.log(resp);\n        let favmovies = resp.FavoriteMovies;\n        localStorage.setItem('FavoriteMovies', favmovies);\n        this.snackBar.open(`${title} has been removed from your favourites!`, 'OK', {\n          duration: 2000\n        });\n      });\n      setTimeout(function () {\n        window.location.reload();\n      }, 1000);\n    }\n\n    deleteUser() {\n      let check = confirm('This will delete your profile! Are you sure you want to continue?');\n\n      if (check) {\n        this.fetchApiData3.deleteUser().subscribe(() => {\n          localStorage.clear();\n          this.router.navigate(['welcome']);\n          this.snackBar.open('Profile deleted', 'OK', {\n            duration: 2000\n          });\n        });\n      } else {\n        window.location.reload();\n      }\n    }\n\n    profileUpdateDialog() {\n      this.dialog.open(UserProfileUpdateComponent, {\n        panelClass: 'update-dialog'\n      });\n    }\n\n  }\n\n  UserProfileComponent.ɵfac = function UserProfileComponent_Factory(t) {\n    return new (t || UserProfileComponent)(i0.ɵɵdirectiveInject(i1.GetAllMoviesService), i0.ɵɵdirectiveInject(i1.DeleteFavouriteMovieService), i0.ɵɵdirectiveInject(i1.DeleteUserService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.MatSnackBar), i0.ɵɵdirectiveInject(i4.MatDialog));\n  };\n\n  UserProfileComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: UserProfileComponent,\n    selectors: [[\"app-user-profile\"]],\n    decls: 28,\n    vars: 8,\n    consts: [[1, \"profile-card-container\"], [1, \"profile-info\"], [1, \"data\"], [1, \"account-container\"], [\"id\", \"update-prof-dialog-button\", \"mat-button\", \"\", 3, \"click\"], [\"id\", \"delete-account-button\", \"mat-button\", \"\", 2, \"color\", \"red\", \"background-color\", \"lightpink\", 3, \"click\"], [1, \"favorite-movies\"], [2, \"display\", \"flex\", \"flex-wrap\", \"wrap\", \"text-align\", \"center\"], [\"style\", \"flex: 0 1 auto; margin: 10px;\", 4, \"ngFor\", \"ngForOf\"], [2, \"flex\", \"0 1 auto\", \"margin\", \"10px\"], [\"aria-label\", \"Remove Movie from Favorite\", 2, \"color\", \"red\", \"font-weight\", \"300\", \"cursor\", \"pointer\", \"right\", \"0\", \"top\", \"0\", \"position\", \"absolute\", \"padding\", \"0\", 3, \"click\"], [3, \"src\", \"alt\"]],\n    template: function UserProfileComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"app-nav-bar\");\n        i0.ɵɵelementStart(1, \"div\", 0);\n        i0.ɵɵelementStart(2, \"h1\");\n        i0.ɵɵtext(3, \"My Profile\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"div\", 1);\n        i0.ɵɵelementStart(5, \"p\", 2);\n        i0.ɵɵtext(6, \"USERNAME\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"p\");\n        i0.ɵɵtext(8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"p\", 2);\n        i0.ɵɵtext(10, \"EMAIL\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"p\");\n        i0.ɵɵtext(12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"p\", 2);\n        i0.ɵɵtext(14, \"BIRTHDAY\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"p\");\n        i0.ɵɵtext(16);\n        i0.ɵɵpipe(17, \"date\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"div\", 3);\n        i0.ɵɵelementStart(19, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function UserProfileComponent_Template_button_click_19_listener() {\n          return ctx.profileUpdateDialog();\n        });\n        i0.ɵɵtext(20, \" Update Profile \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"button\", 5);\n        i0.ɵɵlistener(\"click\", function UserProfileComponent_Template_button_click_21_listener() {\n          return ctx.deleteUser();\n        });\n        i0.ɵɵtext(22, \" Delete Account \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"div\", 6);\n        i0.ɵɵelementStart(24, \"h2\");\n        i0.ɵɵtext(25, \"My Favorite Movies\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"div\", 7);\n        i0.ɵɵtemplate(27, UserProfileComponent_mat_card_27_Template, 10, 4, \"mat-card\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(8);\n        i0.ɵɵtextInterpolate(ctx.user.Username);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(ctx.user.Email);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind3(17, 4, ctx.user.Birthday, \"dd/MM/yyyy\", \"UTC\" || \"N/A\"));\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"ngForOf\", ctx.favorites);\n      }\n    },\n    directives: [i5.NavBarComponent, i6.MatButton, i7.NgForOf, i8.MatCard, i8.MatCardActions, i9.MatIcon, i8.MatCardHeader, i8.MatCardTitle, i8.MatCardSubtitle],\n    pipes: [i7.DatePipe],\n    styles: [\".profile-card-container[_ngcontent-%COMP%]{text-align:center}h1[_ngcontent-%COMP%]{border-bottom:1px solid #d3d3d3;margin-bottom:40px}.account-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;text-align:center;margin:25px}button[_ngcontent-%COMP%]{margin-right:30px;border:.5px solid #d3d3d3}.data[_ngcontent-%COMP%]{font-weight:700}\"]\n  });\n  return UserProfileComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}